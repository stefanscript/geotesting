(this["webpackJsonpgeolocation-testing_react"]=this["webpackJsonpgeolocation-testing_react"]||[]).push([[0],{27:function(e,t,n){},32:function(e,t,n){e.exports=n(42)},37:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(16),r=n.n(i);n(37),n(27);function s(){const e=document.createElement("canvas").getContext("webgl");if(!e)return{error:"no webgl"};const t=e.getExtension("WEBGL_debug_renderer_info");return t?{vendor:e.getParameter(t.UNMASKED_VENDOR_WEBGL),renderer:e.getParameter(t.UNMASKED_RENDERER_WEBGL)}:{error:"no WEBGL_debug_renderer_info"}}function c(){return(new Date).getTimezoneOffset()}function l(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return""}}const d=function(){if("undefined"!==typeof navigator.languages)try{if(navigator.languages[0].substr(0,2)!==navigator.language.substr(0,2))return!0}catch(e){return!0}return!1},u=function(){return window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight},m=function(){var e,t=navigator.userAgent.toLowerCase(),n=navigator.oscpu,a=navigator.platform.toLowerCase();if(e=t.indexOf("windows phone")>=0?"Windows Phone":t.indexOf("win")>=0?"Windows":t.indexOf("android")>=0?"Android":t.indexOf("linux")>=0?"Linux":t.indexOf("iphone")>=0||t.indexOf("ipad")>=0?"iOS":t.indexOf("mac")>=0?"Mac":"Other",("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&"Windows Phone"!==e&&"Android"!==e&&"iOS"!==e&&"Other"!==e)return!0;if("undefined"!==typeof n){if((n=n.toLowerCase()).indexOf("win")>=0&&"Windows"!==e&&"Windows Phone"!==e)return!0;if(n.indexOf("linux")>=0&&"Linux"!==e&&"Android"!==e)return!0;if(n.indexOf("mac")>=0&&"Mac"!==e&&"iOS"!==e)return!0;if((-1===n.indexOf("win")&&-1===n.indexOf("linux")&&-1===n.indexOf("mac"))!==("Other"===e))return!0}return a.indexOf("win")>=0&&"Windows"!==e&&"Windows Phone"!==e||((a.indexOf("linux")>=0||a.indexOf("android")>=0||a.indexOf("pike")>=0)&&"Linux"!==e&&"Android"!==e||((a.indexOf("mac")>=0||a.indexOf("ipad")>=0||a.indexOf("ipod")>=0||a.indexOf("iphone")>=0)&&"Mac"!==e&&"iOS"!==e||((-1===a.indexOf("win")&&-1===a.indexOf("linux")&&-1===a.indexOf("mac"))!==("Other"===e)||"undefined"===typeof navigator.plugins&&"Windows"!==e&&"Windows Phone"!==e)))},h=function(){var e,t=navigator.userAgent.toLowerCase(),n=navigator.productSub;if(("Chrome"===(e=t.indexOf("firefox")>=0?"Firefox":t.indexOf("opera")>=0||t.indexOf("opr")>=0?"Opera":t.indexOf("chrome")>=0?"Chrome":t.indexOf("safari")>=0?"Safari":t.indexOf("trident")>=0?"Internet Explorer":"Other")||"Safari"===e||"Opera"===e)&&"20030107"!==n)return!0;var a,o=eval.toString().length;if(37===o&&"Safari"!==e&&"Firefox"!==e&&"Other"!==e)return!0;if(39===o&&"Internet Explorer"!==e&&"Other"!==e)return!0;if(33===o&&"Chrome"!==e&&"Opera"!==e&&"Other"!==e)return!0;try{throw"a"}catch(i){try{i.toSource(),a=!0}catch(r){a=!1}}return a&&"Firefox"!==e&&"Other"!==e},g={enableHighAccuracy:!0,timeout:1e4,maximumAge:0};let p,f,E={position:"",error:""};function v(){return"geolocation"in navigator}function w(e){v()&&(f=e,navigator.geolocation.getCurrentPosition(O,y,g))}function O(e){console.log("g1");var t=e.coords;E.position=e,console.log(e),f&&f({position:e}),console.log("Your current position is:"),console.log("Latitude : ".concat(t.latitude)),console.log("Longitude: ".concat(t.longitude)),console.log("More or less ".concat(t.accuracy," meters."))}function y(e){let t="unknown error";1===e.code?t="permission denied":2===e.code?t="position unavailable (error response from location provider)":3===e.code&&(t="timed out"),E.error="ERROR(".concat(e.code,"): reason: ").concat(t,", ").concat(e.message),p&&p({error:E.error}),f&&f({error:E.error}),console.warn(E.error)}function b(e){let t;return v()&&(p=e,t=navigator.geolocation.watchPosition(C,y,g)),t}function C(e){var t=e.coords;E.position=e,console.log(e),p&&p({position:e}),console.log("Watch: Your current position is:",new Date),console.log("Latitude : ".concat(t.latitude)),console.log("Longitude: ".concat(t.longitude)),console.log("More or less ".concat(t.accuracy," meters."))}function W(){let e=0;return e+=m()?0:100,e+=h()?0:100,e+=d()?0:100,e+=u()?0:100,e+=P(l())?0:100,e+=x(c())?0:100,parseInt(e/6,10)}function P(e){const t=String(e).toLowerCase();return-1===["america/toronto","america/montreal"].indexOf(t)}function x(e){let t=parseInt(e,10);return!(t<=6&&t>=4)}function S({title:e,value:t}){return o.a.createElement("div",{className:"observation"},e,": ",o.a.createElement("span",null,t))}function A({title:e,passed:t}){return o.a.createElement("div",{className:"observation observation-test ".concat(t?"":"failed")},e,": ",o.a.createElement("span",{className:"result"},JSON.stringify(t)))}var k=n(11);let N={currentPositionAvgAccuracy:-1,lastCurrentPosition:{},watchPositionAvgAccuracy:-1};function T(e){return I({message:e,passed:!0,testFinished:!0})}function F(e){return I({message:e,passed:!1,testFinished:!0})}function I({message:e,passed:t,testFinished:n}){return{message:e,passed:t,testFinished:n}}function L(e){const t=function(e){return e.map((t,n)=>0!==n?e[n].timestamp-e[n-1].timestamp:0)}(e);return console.log("jitters",t),t.filter(e=>0===e).length}function M(e){return e.map((t,n)=>0!==n?e[n].timestampRef-e[n-1].timestampRef:0)}function R(e){if(e.length>0){if(_(e),G(e),console.log("real ref jitters",M(e)),D(e))return F("Watch position - Failed (big jumps detected)");if(L(e)===e.length)return F("Watch position test - Failed (no jitter in ".concat(e.length," samples)"));if(function(e){try{if(e.length>=10){const t=e.filter(e=>1===e.coords.accuracy);return console.log("bad1mAccuracies",t),t.length===e.length}}catch(t){return!1}return!1}(e))return F("Watch position - Failed (accuracy)");if(function(e){try{if(e.length>=10){const t=[...new Set(e.map(e=>e.coords.latitude))],n=[...new Set(e.map(e=>e.coords.longitude))],a=[...new Set(e.map(e=>e.coords.accuracy))];return console.log("constLat",t),console.log("constLong",n),console.log("constAcc",a),1===t.length&&1===a.length&&1===n.length}}catch(t){return!1}return!1}(e))return F("Watch position - Failed (not enough variation in lat, long, acc)");let t=z(e);return N=Object(k.a)(Object(k.a)({},N),{},{watchPositionAvgAccuracy:t}),console.log("watchPosition acc avg",t),function({currentPositionAvgAccuracy:e,watchPositionAvgAccuracy:t}){return console.log("Avg Acc current",e,"vs watch",t),e<t}(N)?F("Accuracy didn't improve - avg"):!function(e){if(e&&e.length>0){const t=e.filter((t,n)=>n>0&&t<=e[n-1]);console.log("accuracy trend",t),console.log("accuracy trend count",t.length,"vs",e.length-1);const n=100*t.length/(e.length-1);return console.log("accuracy trend ",n),n>=60}return!0}(function(e){try{if(e.length>0)return e.map((e,t)=>e.coords.accuracy)}catch(t){return[]}return[]}(e))&&t<=4?F("Accuracy didn't improve - trend"):T("Watch position test - Passed (".concat(e.length," samples)"))}return F("Watch position test - Failed (no geo data)")}function D(e){try{if(e.length>0){console.log("big Positions start");const t=e.map((e,t,n)=>{if(0!==t){return V(n[t-1].coords.latitude,n[t-1].coords.longitude,e.coords.latitude,e.coords.longitude)}return 0});console.log("distances",t);const n=function(e,t){return e.filter(e=>e>t)}(t,10);return console.log("bigJumps",n),n.length>0}}catch(t){return!1}return!1}function V(e,t,n,a){if(e===n&&t===a)return 0;const o=j(n-e),i=j(a-t),r=j(e),s=j(n),c=Math.sin(o/2)*Math.sin(o/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(r)*Math.cos(s);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function j(e){return e*Math.PI/180}function H(e,t,n,a,o,i,r){let s=function(e,t){if(t&&e)return e/t;return 0}(1e3*V(e,t,n,a),(o-i)/1e3);return console.log("velocity",s,"m/s"," #",r),s}function _(e){if(e.length>0){const t=e.map((e,t,n)=>{const a=e.timestampRef,o=e.timestamp;let i=(a-o)/1e3;return console.log(a,"vs",o,i,"sec diff"),i});console.log("timeDiffs",t)}}function G(e){try{if(e.length>0){const t=e[0].coords.latitude,n=e[0].coords.longitude,a=e[0].timestamp,o=e.map((e,o,i)=>{if(0!==o){const i=e.coords.latitude,r=e.coords.longitude,s=e.timestamp;return H(i,r,t,n,s,a,o)}return 0}),i=e.map((e,t,n)=>{if(0!==t){const a=n[t-1].coords.latitude,o=n[t-1].coords.longitude,i=n[t-1].timestamp;return H(e.coords.latitude,e.coords.longitude,a,o,e.timestamp,i,t)}return 0}),r=e.map((e,t,n)=>e.coords.speed);return console.log("velocities",o),console.log("velocities Current",i),console.log("speeds",r),!1}}catch(t){return!1}return!1}function z(e){try{if(e.length>0){const t=e.map((e,t)=>e.coords.accuracy);console.log("accuracies",t);return t.reduce((e,t)=>e+t,0)/t.length}}catch(t){return-1}return-1}const J=function(e,t,n){if(!n.length)return;let a="data:text/csv;charset=utf-8,",o="latitude,longitude,accuracy,altitude,altitudeAccuracy,heading,speed".split(",");a+=o.join(",")+",timestamp,ms,s,jitter,timestampRef,timestampDiffMs,distanceKm,velocity\r\n",n.forEach((function(e,t){const i=t>0?n[t-1]:null;a+=B({item:e,item0:n[0],prevItem:i,heading:o,index:t+1})}));let i=encodeURI(a),r=document.createElement("a");r.setAttribute("href",i),r.setAttribute("download","customers.csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r),r.click(),console.log("clicked")},B=function({item:e,item0:t,prevItem:n,heading:a,index:o}){let i=a.map(t=>null===e.coords[t]?"":e.coords[t].toString());i.push(e.timestamp);const r=e.timestamp-t.timestamp;i.push(r),i.push(r/1e3);const s=n?(e.timestamp-n.timestamp)/1e3:0;i.push(s),i.push(e.timestampRef);const c=e.timestampRef-e.timestamp;console.log("#",o,c),i.push(c);const l=n?V(n.coords.latitude,n.coords.longitude,e.coords.latitude,e.coords.longitude):0;return i.push(l),i.push(H(e.coords.latitude,e.coords.longitude,t.coords.latitude,t.coords.longitude,e.timestamp,t.timestamp,o)),i.join(",")+"\r\n"};function U(e){let t={coords:{},timestamp:e.timestamp,timestampRef:Date.now()};for(let n in e.coords)console.log("key: ",n,e.coords[n]),t.coords[n]=e.coords[n];return t}class Y extends a.Component{constructor(e){super(e),this.state={position:"",error:"",errorOne:"",prevWatchPositions:[],prevOnePositions:[]},this.handleWatchChanges=this.handleWatchChanges.bind(this),this.handleWatchClick=this.handleWatchClick.bind(this),this.handleOneClick=this.handleOneClick.bind(this),this.handleOneChanges=this.handleOneChanges.bind(this),this.downloadWatchCSV=this.downloadWatchCSV.bind(this),this.downloadOneCSV=this.downloadOneCSV.bind(this)}handleWatchChanges({position:e,error:t}){if(t)this.setState({error:t});else{let t=U(e);this.setState({prevWatchPositions:[].concat([...this.state.prevWatchPositions],t)})}}handleOneChanges({position:e,error:t}){if(t)this.setState({errorOne:t});else{let t=U(e);this.setState({prevOnePositions:[].concat([...this.state.prevOnePositions],t)})}}handleWatchClick(e){b(this.handleWatchChanges)}handleOneClick(){w(this.handleOneChanges)}downloadOneCSV(e){return e.stopPropagation(),J(0,0,this.state.prevOnePositions),!1}downloadWatchCSV(e){return e.stopPropagation(),J(0,0,this.state.prevWatchPositions),!1}render(){return o.a.createElement("div",{className:"App"},o.a.createElement("section",{className:"side-container"},o.a.createElement("header",null,"Geolocation"),o.a.createElement("div",{className:"details"},o.a.createElement("h1",null," Watch Position"),o.a.createElement("button",{onClick:this.handleWatchClick},"Start Watching Geolocation"),o.a.createElement("code",null,this.state.error),o.a.createElement("ul",{className:"entries"},o.a.createElement("li",{key:"w0"},o.a.createElement("code",{className:"index-column"},"#"),o.a.createElement("code",null,"latitude"),o.a.createElement("code",null,"longitude"),o.a.createElement("code",null,"accuracy"),o.a.createElement("code",null,"altitude"),o.a.createElement("code",null,"altitudeAccuracy"),o.a.createElement("code",null,"heading"),o.a.createElement("code",null,"speed"),o.a.createElement("code",null,"timestamp")),this.state.prevWatchPositions.map((e,t)=>o.a.createElement("li",{key:"w"+t},o.a.createElement("code",{className:"index-column"},t,"."),o.a.createElement("code",null,e.coords.latitude),o.a.createElement("code",null,e.coords.longitude),o.a.createElement("code",null,e.coords.accuracy,"m"),o.a.createElement("code",null,e.coords.altitude),o.a.createElement("code",null,e.coords.altitudeAccuracy),o.a.createElement("code",null,e.coords.heading),o.a.createElement("code",null,e.coords.speed),o.a.createElement("code",null,"+",e.timestamp-this.state.prevWatchPositions[0].timestamp," ",10===(e.timestamp+"").length?"sec":"ms")))),o.a.createElement("a",{id:"downloadwatchCSV",onClick:this.downloadWatchCSV},"Download CSV"),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement("div",{className:"details"},o.a.createElement("h1",null," One time Position"),o.a.createElement("button",{onClick:this.handleOneClick},"Get Quick Geolocation"),o.a.createElement("code",null,this.state.error),o.a.createElement("ul",{className:"entries"},o.a.createElement("li",{key:"0"},o.a.createElement("code",{className:"index-column"},"#"),o.a.createElement("code",null,"latitude"),o.a.createElement("code",null,"longitude"),o.a.createElement("code",null,"accuracy"),o.a.createElement("code",null,"altitude"),o.a.createElement("code",null,"altitudeAccuracy"),o.a.createElement("code",null,"heading"),o.a.createElement("code",null,"speed"),o.a.createElement("code",null,"timestamp")),this.state.prevOnePositions&&this.state.prevOnePositions.map((e,t)=>o.a.createElement("li",{key:t},o.a.createElement("code",{className:"index-column"},t,"."),o.a.createElement("code",null,e.coords.latitude),o.a.createElement("code",null,e.coords.longitude),o.a.createElement("code",null,e.coords.accuracy,"m"),o.a.createElement("code",null,e.coords.altitude),o.a.createElement("code",null,e.coords.altitudeAccuracy),o.a.createElement("code",null,e.coords.heading),o.a.createElement("code",null,e.coords.speed),o.a.createElement("code",null,"+",e.timestamp-this.state.prevOnePositions[0].timestamp," ",10===(e.timestamp+"").length?"sec":"ms")))),o.a.createElement("a",{id:"downloadoneCSV",onClick:this.downloadOneCSV},"Download CSV")),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",{className:"head"+(W()<50?" sad":"")},o.a.createElement("div",{className:"face"},o.a.createElement("div",{className:"mouth"}),o.a.createElement("div",{className:"eye-group"},o.a.createElement("div",{className:"eye eye-left"}),o.a.createElement("div",{className:"eye eye-right"})))),o.a.createElement("div",null,"Device Confidence: ",W()),o.a.createElement("div",{className:"details"},o.a.createElement(A,{title:"OS ok",passed:!m()}),o.a.createElement(A,{title:"Browser ok",passed:!h()}),o.a.createElement(A,{title:"Languages ok",passed:!d()}),o.a.createElement(S,{title:"Language",value:JSON.stringify(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en")}),o.a.createElement(S,{title:"Languages",value:JSON.stringify(navigator.languages)}),o.a.createElement(A,{title:"Resolution ok",passed:!u()}),o.a.createElement(A,{title:"Timezone IANA",passed:!P(l())}),o.a.createElement(S,{title:"Timezone IANA",value:JSON.stringify(l())}),o.a.createElement(A,{title:"Timezone Offset",passed:!x(c())}),o.a.createElement(S,{title:"Timezone Offset",value:JSON.stringify(c())+"hr(s)"}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null))),o.a.createElement("footer",null))}}var q=Y,K=n(30),Q=n(12);const Z={enableHighAccuracy:!0,timeout:6e4,maximumAge:0};let $,X,ee={position:"",error:""};function te(){return"geolocation"in navigator}function ne(e){const t=e.coords;ee.position=e,console.log(e),X&&X({position:e}),console.log("Your current position is:"),console.log("Latitude : ".concat(t.latitude)),console.log("Longitude: ".concat(t.longitude)),console.log("More or less ".concat(t.accuracy," meters."))}function ae(e){let t="unknown error";1===e.code?t="permission denied":2===e.code?t="position unavailable (error response from location provider)":3===e.code&&(t="timed out"),ee.error="ERROR(".concat(e.code,"): reason: ").concat(t,", ").concat(e.message),$&&$({error:ee.error}),X&&X({error:ee.error}),console.warn(ee.error)}function oe(e){var t=e.coords;ee.position=e,console.log(e),$&&$({position:e}),console.log("Watch: Your current position is:",new Date),console.log("Latitude : ".concat(t.latitude)),console.log("Longitude: ".concat(t.longitude)),console.log("More or less ".concat(t.accuracy," meters."))}function ie(){return-1!==navigator.userAgent.indexOf("Android")&&(-1!==navigator.platform.indexOf("Linux")||-1!==navigator.platform.indexOf("Android"))||-1!==navigator.userAgent.indexOf("iPhone")&&/iPhone/.test(navigator.platform)||-1!==navigator.userAgent.indexOf("iPad")&&/iPad/.test(navigator.platform)}function re(){return-1!==navigator.userAgent.indexOf("Windows")&&-1!==navigator.platform.indexOf("Win32")||-1!==navigator.userAgent.indexOf("Macintosh")&&-1!==navigator.platform.indexOf("MacIntel")}var se=n(46),ce=n(47),le=n(45),de=n(44),ue=n(48);var me=({zoom:e,lat:t=51.504,lng:n=.1,acc:a})=>{const i=[t,n],r=a?Math.floor(a):10;return o.a.createElement(se.a,{center:i,zoom:e},o.a.createElement(ce.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png"}),o.a.createElement(le.a,{center:i,radius:r},o.a.createElement(de.a,{position:i},o.a.createElement(ue.a,null,"A pretty CSS3 popup. ",o.a.createElement("br",null)," Easily customizable."))))};class he extends o.a.Component{constructor(e){super(e),this.isTrustworthy=!1;const t=s().renderer;this.state={currentPositions:[],watchPositions:[],position:{coords:{},timestamp:0},error:"",info:{message:"",testFinished:!1,passed:!1},infoWatch:{message:"",testFinished:!1,passed:!1},infoFinal:{message:"",testFinished:!1,passed:!1},payload:{version:1,source:"WEB",status:"NOLOC",location:{trust:0,latitude:"",longitude:"",accuracy:""},device:{screenRatio:(window.screen.width/window.screen.height).toFixed(2),utcOffset:c(),platform:window.navigator.platform,gpu:t}}},this.handleCurrentPosition=this.handleCurrentPosition.bind(this),this.handleWatchPosition=this.handleWatchPosition.bind(this),this.currentTimerId=0,this.watchTimerId=0}componentDidMount(){const e=this;this.setState({info:{message:"Running current position test....please wait"}}),this.isTrustworthy=ie()||re(),this.isTrustworthyMobile=ie(),this.isTrustworthyDesktop=re(),this.currentTimerId=setInterval(()=>{!function(e){if(!te())throw new Error("geolocation not available");X=e,navigator.geolocation.getCurrentPosition(ne,ae,Z)}(this.handleCurrentPosition)},1e3),setTimeout(()=>{clearInterval(e.currentTimerId),e.runCurrentPositionTest()},12100)}handleCurrentPosition({position:e,error:t}){const n=this;if(e){const t={coords:{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,speed:e.coords.speed},timestamp:e.timestamp,timestampRef:(new Date).getTime()};n.setState({position:t}),n.setState({currentPositions:[...n.state.currentPositions,t]})}t&&n.setState({error:t})}runCurrentPositionTest(){const e=function(e){if(console.log(e.length),e.length>0){if(_(e),G(e),console.log("real ref jitters",M(e)),D(e))return F("Current position - Failed (big jumps detected)");const t=L(e),n=e.length;if(t===n)return F("Current position - Failed (no jitter in ".concat(n," samples)"));let a=z(e);return N=Object(k.a)(Object(k.a)({},N),{},{currentPositionAvgAccuracy:a,lastCurrentPosition:{coords:Object(k.a)({},e[e.length-1].coords),timestamp:e[e.length-1].timestamp}}),console.log("getCurrentPosition acc avg",a),T("Current position - Passed (".concat(n," samples)"))}return F("Current position test - Failed (no geo data)")}(this.state.currentPositions);this.setState({info:Object(k.a)({},e)}),e.passed?this.startWatchTest():this.setState({infoFinal:{message:"Hmm... not enough to continue",passed:!1,testFinished:!0}})}startWatchTest(){if(te()){const e=this;this.setState({infoWatch:{message:"Running watch position test....please wait"}}),e.watchTimerId=function(e){let t;return te()&&($=e,t=navigator.geolocation.watchPosition(oe,ae,Z)),t}(this.handleWatchPosition),setTimeout(()=>{window.navigator.geolocation.clearWatch(e.watchTimerId),e.runWatchPositionTest()},25e3)}}handleWatchPosition({position:e,error:t}){const n=this;if(e){const t={coords:{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,speed:e.coords.speed},timestamp:e.timestamp,timestampRef:(new Date).getTime()};n.setState({position:t}),n.setState({watchPositions:[...n.state.watchPositions,t]})}t&&n.setState({error:t})}runWatchPositionTest(){const e=R(this.state.watchPositions);this.setState({infoWatch:Object(k.a)({},e)}),e.passed?(this.setState({infoFinal:{message:"All good ... you may pass",passed:!0,testFinished:!0}}),this.generatePayload()):this.setState({infoFinal:{message:"Hmm... not enough to continue",passed:!1,testFinished:!0}})}generatePayload(){}render(){let e="";this.state.position.coords&&(e="https://www.google.com/maps/search/?api=1&query=".concat(this.state.position.coords.latitude,",").concat(this.state.position.coords.longitude));this.isTrustworthy;let t=this.isTrustworthyDesktop?"desktop":"none";this.isTrustworthyMobile&&(t="mobile");const n=this.state.position,a=this.state.error,i=window.screen.colorDepth,r=(Math.pow(2,i),s());r.vendor,r.renderer;return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"wrapper"},o.a.createElement("div",{className:"sections"},o.a.createElement("section",{className:"section tests"},o.a.createElement("p",{className:"test ".concat(this.state.info.testFinished?this.state.info.passed?"ok":"not-ok":"not-finished")},this.state.info.message),o.a.createElement("p",{className:"test ".concat(this.state.infoWatch.testFinished?this.state.infoWatch.passed?"ok":"not-ok":"not-finished")},this.state.infoWatch.message),o.a.createElement("p",{className:"test final ".concat(this.state.infoFinal.testFinished?this.state.infoFinal.passed?"ok":"not-ok":"not-finished")},this.state.infoFinal.message)),o.a.createElement("section",{className:"section"},o.a.createElement("textarea",{name:"payload"},JSON.stringify(this.state.payload,void 0,4))),o.a.createElement("section",{className:"section"},o.a.createElement(me,{lat:n.coords.latitude,lng:n.coords.longitude,zoom:13,acc:n.coords.accuracy}),o.a.createElement("div",{className:"position-details"},o.a.createElement("h2",null,"Position ",o.a.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},o.a.createElement("i",{className:"marker"},o.a.createElement("i",{className:"marker-core"})))),o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("div",null,"Latitude"),o.a.createElement("div",null,n.coords.latitude)),o.a.createElement("li",null,o.a.createElement("div",null,"Longitude"),o.a.createElement("div",null,n.coords.longitude)),o.a.createElement("li",null,o.a.createElement("div",null,"Accuracy"),o.a.createElement("div",null,n.coords.accuracy," m")),o.a.createElement("li",null,o.a.createElement("div",null,"Altitude"),o.a.createElement("div",null,n.coords.altitude)),o.a.createElement("li",null,o.a.createElement("div",null,"Altitude Accuracy"),o.a.createElement("div",null,n.coords.altitudeAccuracy)),o.a.createElement("li",null,o.a.createElement("div",null,"Heading"),o.a.createElement("div",null,n.coords.heading)),o.a.createElement("li",null,o.a.createElement("div",null,"Speed"),o.a.createElement("div",null,n.coords.speed))),o.a.createElement("br",null),o.a.createElement("div",{className:a?"text-error":""},a?"Error: "+a:""))))))}componentWillUnmount(){te()&&this.watchTimerId&&navigator.geolocation.clearWatch(this.watchTimerId),this.currentTimerId&&clearInterval(this.currentTimerId)}}var ge=he;function pe(e){let t={coords:{},timestamp:e.timestamp,timestampRef:Date.now()};for(let n in e.coords)console.log("key: ",n,e.coords[n]),t.coords[n]=e.coords[n];return t}class fe extends a.Component{constructor(e){super(e),this.state={position:"",error:"",errorOne:"",prevWatchPositions:[],prevOnePositions:[],watchHandlerId:0},this.handleWatchChanges=this.handleWatchChanges.bind(this),this.handleWatchClick=this.handleWatchClick.bind(this),this.handleOneClick=this.handleOneClick.bind(this),this.handleOneChanges=this.handleOneChanges.bind(this),this.downloadWatchCSV=this.downloadWatchCSV.bind(this),this.downloadOneCSV=this.downloadOneCSV.bind(this)}handleWatchChanges({position:e,error:t}){if(t)this.setState({error:t});else{let t=pe(e);this.setState({prevWatchPositions:[].concat([...this.state.prevWatchPositions],t)})}}handleOneChanges({position:e,error:t}){if(t)this.setState({errorOne:t});else{let t=pe(e);this.setState({prevOnePositions:[].concat([...this.state.prevOnePositions],t)})}}handleWatchClick(e){if(this.state.watchHandlerId)this.stopWatchPosition(this.state.watchHandlerId);else{const e=b(this.handleWatchChanges);this.setState({watchHandlerId:e})}}stopWatchPosition(e){!function(e){v()&&navigator.geolocation.clearWatch(e)}(e),this.setState({watchHandlerId:0})}handleOneClick(){w(this.handleOneChanges)}downloadOneCSV(e){return e.stopPropagation(),!1}downloadWatchCSV(e){return e.stopPropagation(),!1}render(){return o.a.createElement("div",{className:"App"},o.a.createElement("section",{className:"side-container"},o.a.createElement("header",null,"Geolocation"),o.a.createElement("div",{className:"details"},o.a.createElement("h1",null," Watch Position"),o.a.createElement("button",{onClick:this.handleWatchClick,className:this.state.watchHandlerId?"stop":"start"},this.state.watchHandlerId?"Stop":"Start"," Watching Geolocation"),o.a.createElement("code",null,this.state.error),o.a.createElement("ul",{className:"entries"},o.a.createElement("li",{key:"w0"},o.a.createElement("code",{className:"index-column"},"#"),o.a.createElement("code",null,"latitude"),o.a.createElement("code",null,"longitude"),o.a.createElement("code",null,"accuracy"),o.a.createElement("code",null,"altitude"),o.a.createElement("code",null,"altitudeAccuracy"),o.a.createElement("code",null,"heading"),o.a.createElement("code",null,"speed"),o.a.createElement("code",null,"timestamp"),o.a.createElement("code",null,"timestamp")),this.state.prevWatchPositions.map((e,t)=>o.a.createElement("li",{key:"w"+t},o.a.createElement("code",{className:"index-column"},t,"."),o.a.createElement("code",null,e.coords.latitude),o.a.createElement("code",null,e.coords.longitude),o.a.createElement("code",null,e.coords.accuracy,"m"),o.a.createElement("code",null,e.coords.altitude),o.a.createElement("code",null,e.coords.altitudeAccuracy),o.a.createElement("code",null,e.coords.heading),o.a.createElement("code",null,e.coords.speed),o.a.createElement("code",null,e.timestamp),o.a.createElement("code",null,"+",e.timestamp-this.state.prevWatchPositions[0].timestamp," ",10===(e.timestamp+"").length?"sec":"ms")))))),o.a.createElement("footer",null))}}var Ee=fe;function ve(){return o.a.createElement(K.a,null,o.a.createElement("header",null,o.a.createElement("h2",null,"Geo Testing ","v0.3.3")),o.a.createElement(Q.c,null,o.a.createElement(Q.a,{exact:!0,path:"/",component:Ee}),o.a.createElement(Q.a,{path:"/home",component:ge}),o.a.createElement(Q.a,{path:"/test",component:q})))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(ve,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[32,1,2]]]);
//# sourceMappingURL=main.043732c0.chunk.js.map